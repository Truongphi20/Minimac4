<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" class="light-mode">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Minimac4: imputation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Minimac4
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classimputation-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">imputation Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class responsible for managing genotype imputation statistics and timing.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="imputation_8hpp_source.html">imputation.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa44d569a7e3dc905e7b37e98c08cf1e2" id="r_aa44d569a7e3dc905e7b37e98c08cf1e2"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa44d569a7e3dc905e7b37e98c08cf1e2">total_input_time</a> () const</td></tr>
<tr class="memdesc:aa44d569a7e3dc905e7b37e98c08cf1e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total accumulated input time.  <br /></td></tr>
<tr class="separator:aa44d569a7e3dc905e7b37e98c08cf1e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abff7d4c408e2bb1cfeaf971c8dc34ca0" id="r_abff7d4c408e2bb1cfeaf971c8dc34ca0"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abff7d4c408e2bb1cfeaf971c8dc34ca0">total_output_time</a> () const</td></tr>
<tr class="memdesc:abff7d4c408e2bb1cfeaf971c8dc34ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total accumulated output time.  <br /></td></tr>
<tr class="separator:abff7d4c408e2bb1cfeaf971c8dc34ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad44dd832ce70b13983d6eac3c51eac8f" id="r_ad44dd832ce70b13983d6eac3c51eac8f"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad44dd832ce70b13983d6eac3c51eac8f">total_impute_time</a> () const</td></tr>
<tr class="memdesc:ad44dd832ce70b13983d6eac3c51eac8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total accumulated imputation time.  <br /></td></tr>
<tr class="separator:ad44dd832ce70b13983d6eac3c51eac8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5222272b8a616e387a991194235d62" id="r_a7b5222272b8a616e387a991194235d62"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b5222272b8a616e387a991194235d62">impute_chunk</a> (const savvy::region &amp;impute_region, const <a class="el" href="classprog__args.html">prog_args</a> &amp;args, omp::internal::thread_pool2 &amp;tpool, <a class="el" href="classdosage__writer.html">dosage_writer</a> &amp;output)</td></tr>
<tr class="memdesc:a7b5222272b8a616e387a991194235d62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform genotype imputation for a given genomic region.  <br /></td></tr>
<tr class="separator:a7b5222272b8a616e387a991194235d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class responsible for managing genotype imputation statistics and timing. </p>
<p>This class tracks cumulative input, output, and imputation times for genotype imputation runs. It also provides helper methods to record elapsed times and retrieve totals.</p>
<p>The timing values are updated by internal helper functions whenever an operation (e.g., input loading, output writing, or HMM traversal) completes. These values can then be retrieved for reporting and profiling. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a7b5222272b8a616e387a991194235d62" name="a7b5222272b8a616e387a991194235d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b5222272b8a616e387a991194235d62">&#9670;&#160;</a></span>impute_chunk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool imputation::impute_chunk </td>
          <td>(</td>
          <td class="paramtype">const savvy::region &amp;</td>          <td class="paramname"><span class="paramname"><em>impute_region</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classprog__args.html">prog_args</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">omp::internal::thread_pool2 &amp;</td>          <td class="paramname"><span class="paramname"><em>tpool</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdosage__writer.html">dosage_writer</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>output</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform genotype imputation for a given genomic region. </p>
<p>This function loads target haplotypes, reference haplotypes, and executes a Hidden Markov Model (HMM)â€“based imputation algorithm across the specified region. The region is optionally extended by an overlap to reduce edge effects. <br  />
 Results are written to the provided output writer or via temporary files when sample sizes are large.</p>
<p>Workflow:</p><ul>
<li>Extend the target imputation region with overlap.</li>
<li>Load target haplotypes for the region.</li>
<li>Load reference haplotypes (typed-only + full reference panel).</li>
<li>Check ratio of typed to reference variants against thresholds.</li>
<li>Run HMM forward/backward traversal in parallel for each sample haplotype.</li>
<li>Write dosages to temporary files (if buffered) or directly to output.</li>
<li>Merge temporary files if necessary.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">impute_region</td><td>The genomic region to impute (chromosome, start, end). </td></tr>
    <tr><td class="paramname">args</td><td>Program arguments controlling paths, thresholds, buffers, and options. </td></tr>
    <tr><td class="paramname">tpool</td><td>Thread pool for parallel HMM traversal. </td></tr>
    <tr><td class="paramname">output</td><td>Dosage writer for writing final imputation results.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the imputation completed successfully (even if the chunk was skipped), false if an error occurred (e.g., file loading/writing failed).</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>If no reference variants exist in the region, the chunk is skipped.</li>
<li>If the ratio of typed sites to reference sites is below <code>args.min_ratio()</code>, the chunk may be skipped or treated as an error depending on <code>args.fail_min_ratio()</code>.</li>
<li>Target-only variants can be optionally included in the output (<code>--all-typed-sites</code>).</li>
<li>Temporary files are created and merged automatically when processing in buffered groups. </li>
</ul>
</dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classimputation_a7b5222272b8a616e387a991194235d62_cgraph.svg" width="896" height="1530"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classimputation_a7b5222272b8a616e387a991194235d62_icgraph.svg" width="260" height="56"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad44dd832ce70b13983d6eac3c51eac8f" name="ad44dd832ce70b13983d6eac3c51eac8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad44dd832ce70b13983d6eac3c51eac8f">&#9670;&#160;</a></span>total_impute_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long imputation::total_impute_time </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the total accumulated imputation time. </p>
<dl class="section return"><dt>Returns</dt><dd>Total imputation time in seconds. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classimputation_ad44dd832ce70b13983d6eac3c51eac8f_icgraph.svg" width="334" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa44d569a7e3dc905e7b37e98c08cf1e2" name="aa44d569a7e3dc905e7b37e98c08cf1e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa44d569a7e3dc905e7b37e98c08cf1e2">&#9670;&#160;</a></span>total_input_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long imputation::total_input_time </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the total accumulated input time. </p>
<dl class="section return"><dt>Returns</dt><dd>Total input time in seconds. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classimputation_aa44d569a7e3dc905e7b37e98c08cf1e2_icgraph.svg" width="320" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abff7d4c408e2bb1cfeaf971c8dc34ca0" name="abff7d4c408e2bb1cfeaf971c8dc34ca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abff7d4c408e2bb1cfeaf971c8dc34ca0">&#9670;&#160;</a></span>total_output_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long imputation::total_output_time </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the total accumulated output time. </p>
<dl class="section return"><dt>Returns</dt><dd>Total output time in seconds. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classimputation_abff7d4c408e2bb1cfeaf971c8dc34ca0_icgraph.svg" width="330" height="39"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="imputation_8hpp_source.html">imputation.hpp</a></li>
<li>src/<a class="el" href="imputation_8cpp.html">imputation.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
